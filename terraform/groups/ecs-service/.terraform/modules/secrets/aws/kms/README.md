# kms

> This project was generated by [generator-tf-module](https://github.com/sudokar/generator-tf-module)

## Overview

A Terraform module that can create the necessary KMS keys in the appropriate account.

## Usage

```hcl

provider "aws" {
}

module "kms" {
  source                  = "../../kms"
  kms_key_alias           = var.name
  description             = "${var.name} testing key"
  deletion_window_in_days = 7
  enable_key_rotation     = false
  is_enabled              = true

  kmsadmin_principals            = null
  kmsuser_principals             = null
  key_usage_foreign_account_ids  = null
  key_grant_foreign_account_ids  = null
  service_linked_role_principals = ["autoscaling.amazonaws.com/AWSServiceRoleForAutoScaling"]

  tags = {
    Environment = "Test"
  }
}



```

<!-- BEGINNING OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.3, < 2.0 |
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | >= 5.0, < 6.0 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_aws"></a> [aws](#provider\_aws) | >= 5.0, < 6.0 |

## Modules

No modules.

## Resources

| Name | Type |
|------|------|
| [aws_kms_alias.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_alias) | resource |
| [aws_kms_key.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key) | resource |
| [aws_caller_identity.current](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/caller_identity) | data source |
| [aws_iam_policy_document.key_policy](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) | data source |
| [aws_region.current](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/region) | data source |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_cloudtrail_account_ids"></a> [cloudtrail\_account\_ids](#input\_cloudtrail\_account\_ids) | List of account IDs to allow Cloudtrail to use this key for encrypt and describe operations. | `list(string)` | `null` | no |
| <a name="input_deletion_window_in_days"></a> [deletion\_window\_in\_days](#input\_deletion\_window\_in\_days) | Duration in days after which the key is deleted after destruction of the resource | `number` | `10` | no |
| <a name="input_description"></a> [description](#input\_description) | Description field for the CMK | `string` | n/a | yes |
| <a name="input_enable_key_rotation"></a> [enable\_key\_rotation](#input\_enable\_key\_rotation) | Specifies whether key rotation is enabled | `bool` | `true` | no |
| <a name="input_is_enabled"></a> [is\_enabled](#input\_is\_enabled) | (Optional) Specifies whether the key is enabled. Defaults to true. | `bool` | `true` | no |
| <a name="input_key_grant_foreign_account_ids"></a> [key\_grant\_foreign\_account\_ids](#input\_key\_grant\_foreign\_account\_ids) | List of remote account ID's to allow to create grants on this key | `list(string)` | `null` | no |
| <a name="input_key_usage_foreign_account_ids"></a> [key\_usage\_foreign\_account\_ids](#input\_key\_usage\_foreign\_account\_ids) | List of remote account ID's to delegate access to this key to | `list(string)` | `null` | no |
| <a name="input_kms_key_alias"></a> [kms\_key\_alias](#input\_kms\_key\_alias) | The display name of the key | `string` | `null` | no |
| <a name="input_kmsadmin_principals"></a> [kmsadmin\_principals](#input\_kmsadmin\_principals) | KMS Key Admin IAM Principals, will be specifically granted full access (including key deletion) to this key. e.g. `user/username`, `role/rolename` | `list(string)` | `null` | no |
| <a name="input_kmsuser_principals"></a> [kmsuser\_principals](#input\_kmsuser\_principals) | KMS Key User IAM Principals, will be specifically granted usage of this key | `list(string)` | `null` | no |
| <a name="input_service_linked_role_principals"></a> [service\_linked\_role\_principals](#input\_service\_linked\_role\_principals) | List of service linked role principles in the local account to allow usage and delegation of the key, e.g. `autoscaling.amazonaws.com/AWSServiceRoleForAutoScaling` | `list(string)` | `null` | no |
| <a name="input_service_principal_names"></a> [service\_principal\_names](#input\_service\_principal\_names) | List of AWS service names allowed to use this key | `list(string)` | `null` | no |
| <a name="input_service_principal_names_non_region"></a> [service\_principal\_names\_non\_region](#input\_service\_principal\_names\_non\_region) | List of AWS service names allowed to use this key - without region | `list(string)` | `null` | no |
| <a name="input_tags"></a> [tags](#input\_tags) | A map of tags to add to all resources | `map(string)` | `{}` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_key_alias_arn"></a> [key\_alias\_arn](#output\_key\_alias\_arn) | The Amazon Resource Name (ARN) of the key alias |
| <a name="output_key_alias_name"></a> [key\_alias\_name](#output\_key\_alias\_name) | The display name of the alias. |
| <a name="output_key_arn"></a> [key\_arn](#output\_key\_arn) | The Amazon Resource Name (ARN) of the key. |
| <a name="output_key_id"></a> [key\_id](#output\_key\_id) | The globally unique identifier for the key. |
<!-- END OF PRE-COMMIT-TERRAFORM DOCS HOOK -->

## Development

### Prerequisites

- [terraform](https://learn.hashicorp.com/terraform/getting-started/install#installing-terraform)
- [terraform-docs](https://github.com/segmentio/terraform-docs)
- [pre-commit](https://pre-commit.com/#install)
- [golang](https://golang.org/doc/install#install)
- [golint](https://github.com/golang/lint#installation)

### Configurations

- Configure pre-commit hooks
```sh
pre-commit install
```


- Configure golang deps for tests
```sh
> go get github.com/gruntwork-io/terratest/modules/terraform
> go get github.com/stretchr/testify/assert
```



### Tests

- Tests are available in `test` directory

- In the test directory, run the below command
```sh
go test
```



## Authors

This project is authored by below people

- Raja Tatapudi

> This project was generated by [generator-tf-module](https://github.com/sudokar/generator-tf-module)
